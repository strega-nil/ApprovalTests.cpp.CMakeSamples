<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /add_subdirectory_approvaltests_catch2/mdsource/README.source.md
To change this file edit the source file and then execute ./run_markdown_templates.sh.
-->

# add_subdirectory_approvaltests_catch2

 <!-- include: add_subdirectory_approvaltests_catch2. path: /add_subdirectory_approvaltests_catch2/mdsource/add_subdirectory_approvaltests_catch2.include.md -->
| Topic        | Detail                                                       |
| ------------ | ------------------------------------------------------------ |
| Directory    | [add_subdirectory_approvaltests_catch2](/add_subdirectory_approvaltests_catch2/) |
| Purpose      | Demo how to build your tests against clones or forks of ApprovalTests.cpp and Catch2.<br />Those source code of those dependencies will be included in your IDE, alongside your own source code.<br />This allows you to make edits to the dependent projects. |
| Dependencies | ApprovalTests.cpp - cloned on your machine<br />Catch2 - cloned on your machine |
| Mechanism    | Uses CMake's [`add_subdirectory()`](https://cmake.org/cmake/help/latest/command/add_subdirectory.html) |
| More Detail  | See [Use own ApprovalTests.cpp and Catch2 clones](https://github.com/approvals/ApprovalTests.cpp/blob/master/doc/CMakeIntegration.md#use-own-approvaltestscpp-and-catch2-clones) |
 <!-- end include: add_subdirectory_approvaltests_catch2. path: /add_subdirectory_approvaltests_catch2/mdsource/add_subdirectory_approvaltests_catch2.include.md -->

The top-level CMakeLists.txt file is:

 <!-- include: inc_add_subdirectory_approvaltests_catch2_cmakelists. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_cmakelists.include.md -->

```cmake
cmake_minimum_required(VERSION 3.8 FATAL_ERROR)

project(add_subdirectory_approvaltests_catch2)

enable_testing()

add_subdirectory(dependencies)
add_subdirectory(tests)
```
<sup><a href='https://github.com/claremacrae/ApprovalTests.cpp.CMakeSamples/blob/main/./add_subdirectory_approvaltests_catch2/CMakeLists.txt' title='File snippet was copied from'>snippet source</a></sup>
 <!-- end include: inc_add_subdirectory_approvaltests_catch2_cmakelists. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_cmakelists.include.md -->

The CMakeLists.txt to pull in dependencies is:

 <!-- include: inc_add_subdirectory_approvaltests_catch2_dependencies_cmakelists. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_dependencies_cmakelists.include.md -->

```cmake
# -------------------------------------------------------------------
# ApprovalTests.cpp
add_subdirectory(
        ../../ApprovalTests.cpp
        ${CMAKE_CURRENT_BINARY_DIR}/approvaltests.cpp_build
)

# -------------------------------------------------------------------
# Catch2
set(CATCH_BUILD_TESTING OFF CACHE BOOL "")
add_subdirectory(
        ../../Catch2
        ${CMAKE_CURRENT_BINARY_DIR}/catch2_build
)
```
<sup><a href='https://github.com/claremacrae/ApprovalTests.cpp.CMakeSamples/blob/main/./add_subdirectory_approvaltests_catch2/dependencies/CMakeLists.txt' title='File snippet was copied from'>snippet source</a></sup>
 <!-- end include: inc_add_subdirectory_approvaltests_catch2_dependencies_cmakelists. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_dependencies_cmakelists.include.md -->

And the CMakeLists.txt that builds the tests is:

 <!-- include: inc_add_subdirectory_approvaltests_catch2_tests_cmakelists. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_tests_cmakelists.include.md -->

```cmake
add_executable(tests
        main.cpp
        tests.cpp
)
target_link_libraries(tests ApprovalTests::ApprovalTests Catch2::Catch2)

target_compile_features(tests PUBLIC cxx_std_11)
set_target_properties(tests PROPERTIES CXX_EXTENSIONS OFF)

add_test(
        NAME tests
        COMMAND tests)
```
<sup><a href='https://github.com/claremacrae/ApprovalTests.cpp.CMakeSamples/blob/main/./add_subdirectory_approvaltests_catch2/tests/CMakeLists.txt' title='File snippet was copied from'>snippet source</a></sup>
 <!-- end include: inc_add_subdirectory_approvaltests_catch2_tests_cmakelists. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_tests_cmakelists.include.md -->

The build script is:

 <!-- include: inc_add_subdirectory_approvaltests_catch2_build. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_build.include.md -->

```cmake
#!/bin/sh

# Force execution to halt if there are any errors in this script:
set -e
set -o pipefail

sourcedir=`pwd`
mkdir -p cmake-build-spaces/cmake-build-command-line
cd       cmake-build-spaces/cmake-build-command-line
cmake -Wdev $sourcedir
cmake --build .
ctest .
```
<sup><a href='https://github.com/claremacrae/ApprovalTests.cpp.CMakeSamples/blob/main/./add_subdirectory_approvaltests_catch2/build.sh' title='File snippet was copied from'>snippet source</a></sup>
 <!-- end include: inc_add_subdirectory_approvaltests_catch2_build. path: /add_subdirectory_approvaltests_catch2/mdsource/inc_add_subdirectory_approvaltests_catch2_build.include.md -->
